

import asyncio, random, re, logging, sys, time
from playwright.async_api import async_playwright, TimeoutError as PlaywrightTimeoutError
import requests, io
from PIL import Image
from urllib.parse import urljoin, urlparse
from duckduckgo_search import DDGS

# === CONFIG ===
BOT_TOKEN = "7619040891:AAF9pfQQme32XvhTfUb97jzky5w4ZEaBzwc"
CHAT_ID = "5172045930"
DEBUG = False

NAME = "Kevin Fang"
EMAIL = "kevandcoceo@hotmail.com"
PHONE = "+365433225"
ADDRESS = "123 Main St, New York, NY 10001"
SUBJECT = "Partnership with Concierge"
MESSAGE = "Hi I'm Kevin, I run a concierge service and I get a few issues with one of my clients, a politician and ive been subpeoned i need someone to represewnt me i have done nothing wrong kindly reach oput via email as im not in the states currently "

KEYWORDS = [
    "lawq USA contact",
    "luxury lawyers enquiry",
    "lawyers Europe contact"
]
CONTACT_KEYWORDS = ["contact", "enquiry", "connect", "getintouch", "message", "reach", "touch"]

# Enhanced cookie selectors (30+ variations)
COOKIE_SELECTORS = [
    "#cookie-consent", ".cookie-banner", "#cookie-notice", "#cookiePolicy",
    "#acceptCookies", ".btn-cookies", ".cookie-accept", ".cookie-ok", "#gdpr-consent",
    ".cookie-agree", "#CybotCookiebotDialogBodyLevelButtonLevelOptinAllowAll",
    ".cc-btn", ".cookie-notice-actions button", "button:has-text('Accept')",
    "button:has-text('Agree')", "button:has-text('Allow')", "button:has-text('OK')",
    "button:has-text('I accept')", "button:has-text('I agree')", "button:has-text('Consent')",
    "button:has-text('Got it')", "button:has-text('Close')", "button:has-text('Continue')",
    "button:has-text('Dismiss')", "button:has-text('Yes')", "button:has-text('Accept All')",
    "button:has-text('Allow All')", "button:has-text('I Understand')", "#cookie-accept",
    ".cookie-button", ".cookie-allow", "#acceptCookie", ".btn-cookie", "#cookieAgree",
    "#cookie-ok", "#gdpr-accept", ".js-cookie-accept", ".cookie-close"
]

# Terms checkbox detection keywords
TERMS_KEYWORDS = ["terms", "conditions", "privacy", "policy", "agree", "accept", "gdpr", "consent"]

# Popup/dialog selectors
POPUP_SELECTORS = [
    ".modal", ".popup", ".dialog", ".lightbox", "#modal", "#popup",
    "div[role='dialog']", "div[class*='modal']", "div[class*='popup']",
    ".overlay", ".notice", ".alert", ".notification", ".interstitial",
    ".slide-in", ".banner", ".ad-container", ".newsletter-popup"
]

# Navigation patterns for contact pages
CONTACT_NAV_PATTERNS = [
    "//a[contains(translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'contact')]",
    "//a[contains(translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'enquiry')]",
    "//a[contains(translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'connect')]",
    "//a[contains(translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'message')]",
    "//a[contains(@href, 'contact')]",
    "//a[contains(@href, 'enquiry')]",
    "//a[contains(@href, 'connect')]",
    "//a[contains(@id, 'contact')]",
    "//a[contains(@class, 'contact')]",
    "//a[contains(@title, 'Contact')]",
    "//button[contains(., 'Contact')]",
    "//button[contains(., 'Enquire')]"
]

logging.basicConfig(level=logging.INFO, format="%(asctime)s %(levelname)s %(message)s", handlers=[logging.StreamHandler(sys.stdout)])
logger = logging.getLogger("mainguy")

# Track visited domains to avoid duplicates
visited_domains = set()

def send_to_telegram(image_bytes, caption):
    try:
        # Validate image
        if not image_bytes or len(image_bytes) < 1024:
            logger.error("Invalid image for Telegram")
            return
            
        # Create image
        img = Image.open(io.BytesIO(image_bytes))
        buf = io.BytesIO()
        img.save(buf, format="JPEG", quality=85)
        buf.seek(0)
        
        # Prepare request
        files = {"photo": ("screenshot.jpg", buf.getvalue())}
        data = {"chat_id": CHAT_ID, "caption": caption[:1024]}  # Truncate long captions
        
        # Send with timeout
        with requests.Session() as session:
            r = session.post(
                f"https://api.telegram.org/bot{BOT_TOKEN}/sendPhoto",
                data=data,
                files=files,
                timeout=15
            )
            
            if r.status_code == 200:
                logger.info("Telegram: Message sent successfully")
            else:
                logger.error(f"Telegram error: {r.status_code} - {r.text}")
    except Exception as e:
        logger.error(f"Telegram send error: {e}")

# -----------------------------------
# FUNCTION: handle popups and banners
# -----------------------------------
async def handle_popups(page):
    # Try to close any popups/modals
    for selector in POPUP_SELECTORS:
        try:
            popup = await page.query_selector(selector)
            if popup:
                # Look for close buttons in the popup
                close_btn = await popup.query_selector(
                    ".close, .dismiss, [aria-label='Close'], [aria-label='Dismiss'], "
                    "[title='Close'], [title='Dismiss'], .btn-close, .popup-close, "
                    ".modal-close, .close-button, .close-icon"
                )
                
                if not close_btn:
                    # Try text-based close buttons
                    close_btn = await popup.query_selector(
                        "button:has-text('Close'), button:has-text('Dismiss'), "
                        "button:has-text('No thanks'), button:has-text('Maybe later'), "
                        "button:has-text('Not now'), button:has-text('Decline')"
                    )
                
                if close_btn:
                    await close_btn.scroll_into_view_if_needed()
                    await close_btn.click()
                    logger.info(f"✅ Closed popup with selector: {selector}")
                    await asyncio.sleep(1)
                    return True
        except Exception as e:
            logger.debug(f"Popup close failed: {str(e)}")
    return False

# -----------------------------------
# FUNCTION: handle cookies (enhanced with retries)
# -----------------------------------
async def handle_cookie_consent(page):
    # Try multiple times as cookies might appear after delay
    for attempt in range(3):
        for sel in COOKIE_SELECTORS:
            try:
                # Try visible buttons first
                btn = await page.query_selector(f"{sel}:visible")
                if not btn:
                    # Fallback to all elements matching selector
                    btn = await page.query_selector(sel)
                
                if btn:
                    await btn.scroll_into_view_if_needed()
                    await btn.click()
                    logger.info(f"✅ Clicked cookie button using selector: {sel}")
                    await asyncio.sleep(1)
                    return True
            except Exception as e:
                logger.debug(f"Cookie click failed on {sel}: {str(e)}")
        
        # Wait before next attempt
        await asyncio.sleep(1)
    return False

# -----------------------------------
# FUNCTION: find contact pages (completely overhauled)
# -----------------------------------
async def find_contact_pages(page, base_url):
    try:
        # Try direct contact page paths first
        common_paths = [
            "/contact", "/contact-us", "/contactus", "/contact.html", 
            "/contact.php", "/contact.aspx", "/en/contact", "/contact-form",
            "/get-in-touch", "/reach-out", "/connect", "/contacto", "/kontakt",
            "/contact-us.html", "/contact-us.php", "/contact-us.aspx",
            "/contact-us/", "/contactus/", "/contact-us-page", "/contact-page"
        ]
        
        # Try each common path directly
        found = set()
        for path in common_paths:
            contact_url = urljoin(base_url, path)
            if urlparse(contact_url).netloc == urlparse(base_url).netloc:
                found.add(contact_url)
        
        # Now try to navigate the site to find contact pages
        await page.goto(base_url, timeout=60000)
        await handle_popups(page)
        await handle_cookie_consent(page)
        
        # Try to find contact links using multiple methods
        try:
            # Method 1: CSS selectors
            contact_links = await page.query_selector_all(
                "a[href*='contact'], a:has-text('contact'), "
                "a[href*='enquiry'], a:has-text('enquiry'), "
                "a[href*='connect'], a:has-text('connect')"
            )
            
            for link in contact_links:
                href = await link.get_attribute("href") or ""
                if href and not href.startswith(("javascript:", "mailto:", "tel:")):
                    full_url = urljoin(base_url, href)
                    if urlparse(full_url).netloc == urlparse(base_url).netloc:
                        found.add(full_url)
            
            # Method 2: XPath patterns
            for pattern in CONTACT_NAV_PATTERNS:
                try:
                    links = await page.query_selector_all(f"xpath={pattern}")
                    for link in links:
                        href = await link.get_attribute("href") or ""
                        if href and not href.startswith(("javascript:", "mailto:", "tel:")):
                            full_url = urljoin(base_url, href)
                            if urlparse(full_url).netloc == urlparse(base_url).netloc:
                                found.add(full_url)
                except:
                    continue
            
            # Method 3: Navigation menus
            menu_items = await page.query_selector_all(
                "nav a, .menu a, .navigation a, .header-nav a, .footer-nav a"
            )
            for item in menu_items:
                text = (await item.text_content() or "").lower()
                href = await item.get_attribute("href") or ""
                if any(kw in text for kw in CONTACT_KEYWORDS) and href:
                    full_url = urljoin(base_url, href)
                    if urlparse(full_url).netloc == urlparse(base_url).netloc:
                        found.add(full_url)
            
            # Method 4: Footer links
            footer_links = await page.query_selector_all(
                "footer a, .footer a, .site-footer a"
            )
            for link in footer_links:
                text = (await link.text_content() or "").lower()
                href = await link.get_attribute("href") or ""
                if any(kw in text for kw in CONTACT_KEYWORDS) and href:
                    full_url = urljoin(base_url, href)
                    if urlparse(full_url).netloc == urlparse(base_url).netloc:
                        found.add(full_url)
        
        except Exception as e:
            logger.error(f"Error finding contact links: {str(e)}")
        
        return list(found)
    except Exception as e:
        logger.error(f"find_contact error: {e}")
        return []

# -----------------------------------
# SMART FORM FILLING (enhanced with all requirements)
# -----------------------------------
async def try_fill_form(page, url):
    try:
        await page.goto(url, timeout=60000)
        await handle_popups(page)
        await handle_cookie_consent(page)
        
        # Wait for page to settle
        await asyncio.sleep(1)
        
        # Enhanced form selectors
        form_selectors = [
            "form", 
            ".contact-form", 
            "#contactForm", 
            "#enquiryForm",
            ".wpcf7-form", 
            ".gravity-form", 
            ".forminator-form", 
            ".elementor-form",
            "form[role='form']",
            ".gform_wrapper",
            ".contact-form-7",
            ".hs-form",  # HubSpot
            ".form",     # Generic
            ".webform",  # Drupal
            ".form-container",
            ".form-wrapper",
            ".form-contact",
            ".enquiry-form",
            "form[class*='contact']",
            "form[id*='contact']",
            "form[name*='contact']",
            "div[class*='form']"  # Sometimes forms are in div containers
        ]
        
        forms = []
        for selector in form_selectors:
            try:
                found_forms = await page.query_selector_all(selector)
                if found_forms:
                    forms.extend(found_forms)
            except:
                continue
        
        if not forms:
            logger.info(f"{url} → no forms found")
            return False
        else:
            logger.info(f"{url} → found {len(forms)} forms")

        for form in forms:
            inputs = await form.query_selector_all("input, textarea, select")
            filled = False
            
            for inp in inputs:
                t = (await inp.get_attribute("type") or "").lower()
                if t in ["hidden", "submit", "button", "image", "reset", "checkbox", "radio"]:
                    continue
                    
                # Get context from multiple attributes
                ph = (await inp.get_attribute("placeholder") or "").lower()
                nm = (await inp.get_attribute("name") or "").lower()
                id_attr = (await inp.get_attribute("id") or "").lower()
                lbl_text = ""
                
                # Get label text if exists
                if id_attr:
                    lbl = await page.query_selector(f'label[for="{id_attr}"]')
                    lbl_text = (await lbl.text_content() or "").lower() if lbl else ""
                
                # Determine field context
                context = None
                field_text = ph + nm + id_attr + lbl_text
                
                if any(x in field_text for x in ["mail", "e-mail", "email"]):
                    context = "email"
                elif any(x in field_text for x in ["name", "fullname", "first", "last", "fname", "lname"]):
                    context = "name"
                elif any(x in field_text for x in ["phone", "mobile", "tel", "telephone"]):
                    context = "phone"
                elif any(x in field_text for x in ["subject", "title", "reason", "topic"]):
                    context = "subject"
                elif any(x in field_text for x in ["address", "street", "city", "zip", "location", "country"]):
                    context = "address"
                elif any(x in field_text for x in ["message", "comment", "enquiry", "content", "details"]):
                    context = "message"
                elif await inp.evaluate("el => el.tagName") == "TEXTAREA":
                    context = "message"
                
                if not context:
                    continue
                    
                # Get appropriate value
                val = {
                    "email": EMAIL,
                    "name": NAME,
                    "phone": PHONE,
                    "subject": SUBJECT,
                    "address": ADDRESS,
                    "message": MESSAGE
                }[context]
                
                # Handle different input types
                tag_name = await inp.evaluate("el => el.tagName")
                if tag_name == "SELECT":
                    try:
                        # Get all options
                        options = await inp.query_selector_all("option")
                        if len(options) > 1:
                            # Try to select the second option
                            await options[1].click()
                            logger.info(f"🔘 Selected second dropdown option")
                        else:
                            await inp.select_option(val)
                            logger.info(f"🔘 Selected dropdown value")
                    except:
                        # Fallback to typing if direct selection fails
                        await inp.focus()
                        await page.keyboard.type(val, delay=100)
                        logger.info(f"⌨️ Typed dropdown value")
                else:
                    try:
                        await inp.fill(val)
                        logger.info(f"✍️ {context} field filled")
                    except:
                        await page.keyboard.type(val, delay=random.randint(50, 150))
                        logger.info(f"⌨️ Typed {context} value")
                
                filled = True
                
            # Handle terms checkboxes
            checkboxes = await form.query_selector_all("input[type='checkbox']")
            for cb in checkboxes:
                # Check if nearby text contains terms keywords
                parent = await cb.query_selector("xpath=..")  # Get parent element
                if parent:
                    parent_text = (await parent.text_content() or "").lower()
                    if any(term in parent_text for term in TERMS_KEYWORDS):
                        if not await cb.is_checked():
                            await cb.check()
                            logger.info("✅ Checked terms checkbox")
                            filled = True
            
            if not filled:
                logger.info("⚠️ No fillable fields found in form")
                continue
                
            # Submit handling with multiple attempts
            submit_selectors = [
                "input[type=submit]", 
                "button[type=submit]", 
                "button:has-text('Send')",
                "button:has-text('Submit')",
                "button:has-text('Contact')",
                "button:has-text('Enquire')",
                "button:has-text('Reach Out')",
                "button:has-text('Send Message')",
                "button:has-text('Request Quote')",
                "button:has-text('Get in Touch')",
                "button:has-text('Submit Form')",
                "button:has-text('Send Enquiry')",
                "button:has-text('Submit Request')"
            ]
            
            submitted = False
            for selector in submit_selectors:
                try:
                    btn = await form.query_selector(selector)
                    if btn:
                        await btn.scroll_into_view_if_needed()
                        await btn.click()
                        
                        # Wait for navigation or 5 seconds
                        try:
                            await page.wait_for_navigation(timeout=5000)
                        except:
                            await asyncio.sleep(5)  # Wait 5 seconds if no navigation
                            
                        submitted = True
                        break
                except:
                    continue
                    
            if not submitted:
                # Fallback to form submission
                try:
                    await form.evaluate("form => form.submit()")
                    await asyncio.sleep(5)  # Wait 5 seconds after submission
                    submitted = True
                except:
                    pass
            
            # Wait for any post-submission changes
            await asyncio.sleep(2)
            img = await page.screenshot()
            
            # Verify submission by URL change or content
            current_url = page.url
            html = (await page.content()).lower()
            
            success_indicators = [
                "thank you", "submitted", "we'll contact", "success", 
                "received", "confirmation", "successfully", "message sent",
                "enquiry received", "contact received", "form submitted",
                "thank you for your message", "thank you for contacting"
            ]
            
            if submitted:
                if any(x in current_url for x in ["thank", "success", "confirmation"]) or any(x in html for x in success_indicators):
                    logger.info("✅ Form submitted successfully")
                    send_to_telegram(img, f"Success: {url}\nNew URL: {current_url}")
                else:
                    logger.info("⚠️ Form submitted but success not confirmed")
                    send_to_telegram(img, f"Submitted/Unconfirmed: {url}\nCurrent URL: {current_url}")
                return True
            else:
                logger.info("⚠️ Form filled but no submit button found")
                send_to_telegram(img, f"Filled w/o submit: {url}")
                return True
                
        return False
    except PlaywrightTimeoutError:
        logger.error("Timeout on " + url)
        try:
            img = await page.screenshot()
            send_to_telegram(img, f"Timeout error: {url}")
        except:
            pass
    except Exception as e:
        logger.error(f"form fill error: {e}")
        try:
            img = await page.screenshot()
            send_to_telegram(img, f"Error: {url}\n{str(e)}")
        except:
            pass
    return False

# -----------------------------------
# DUCKDUCKGO SEARCH WITH RETRIES
# -----------------------------------
def duckduckgo_search_with_retry(query, max_results=5, retries=3, backoff_factor=2):
    """Custom DuckDuckGo search function with retries and delays"""
    for attempt in range(retries):
        try:
            # Perform search
            logger.info(f"Searching DuckDuckGo for: '{query}'")
            with DDGS() as ddgs:
                results = []
                for r in ddgs.text(query):
                    results.append(r["href"])
                    if len(results) >= max_results:
                        break
                return results
        except Exception as e:
            wait_time = backoff_factor ** (attempt + 1) + random.uniform(1, 5)
            logger.warning(f"Search error: {str(e)}. Waiting {wait_time:.1f}s before retry {attempt+1}/{retries}")
            time.sleep(wait_time)
    
    logger.error(f"Failed to search '{query}' after {retries} retries")
    return []

# -----------------------------------
# MAIN EXECUTION FLOW (continuous scanning)
# -----------------------------------
async def main():
    async with async_playwright() as pw:
        browser = await pw.chromium.launch(
            headless=not DEBUG,
            args=["--window-size=1280,720", "--disable-blink-features=AutomationControlled"],
            channel="chrome"
        )
        
        context = await browser.new_context(
            viewport={"width": 1280, "height": 720},
            user_agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"
        )
        
        page = await context.new_page()
        
        # Continuous scanning loop
        while True:
            for kw in KEYWORDS:
                logger.info(f"🔍 Searching: {kw}")
                try:
                    search_results = duckduckgo_search_with_retry(kw, max_results=5)
                    
                    if not search_results:
                        logger.warning(f"No results found for '{kw}'")
                        continue
                        
                    for res in search_results:
                        try:
                            domain = urlparse(res).netloc
                            
                            # Skip if we've already visited this domain
                            if domain in visited_domains:
                                logger.info(f"⏩ Skipping already processed domain: {domain}")
                                continue
                                
                            visited_domains.add(domain)
                            base = f"{urlparse(res).scheme}://{domain}"
                            logger.info(f"🌐 Processing domain: {domain}")
                            
                            # Find and process contact pages
                            contact_pages = await find_contact_pages(page, base)
                            
                            if not contact_pages:
                                logger.info(f"No contact pages found for {domain}")
                                # Try common contact page as fallback
                                contact_url = urljoin(base, "/contact")
                                logger.info(f"🔄 Trying fallback contact page: {contact_url}")
                                contact_pages = [contact_url]
                            
                            for cp in contact_pages:
                                logger.info(f"📝 Attempting contact page: {cp}")
                                if await try_fill_form(page, cp):
                                    break
                                    
                            await asyncio.sleep(random.uniform(5, 15))
                        except Exception as e:
                            logger.error(f"Error processing {res}: {str(e)}")
                            continue
                except Exception as e:
                    logger.error(f"Search error for '{kw}': {str(e)}")
                    
            # Pause before next scan cycle
            wait_time = random.randint(45, 90)
            logger.info(f"🔄 Completed keyword cycle, restarting in {wait_time} seconds")
            await asyncio.sleep(wait_time)

if __name__ == "__main__":
    asyncio.run(main())








\Users\Administrator\Desktop\form filler>py f2.py
2025-08-03 08:29:49,678 INFO 🔍 Searching: lawq USA contact
2025-08-03 08:29:49,679 INFO Searching DuckDuckGo for: 'lawq USA contact'
C:\Users\Administrator\Desktop\form filler\f2.py:505: RuntimeWarning: This package (`duckduckgo_search`) has been renamed to `ddgs`! Use `pip install ddgs` instead.
  with DDGS() as ddgs:
2025-08-03 08:29:50,223 INFO response: https://www.bing.com/search?q=lawq+USA+contact 200
2025-08-03 08:29:50,362 INFO 🌐 Processing domain: www.climatempo.com.br
2025-08-03 08:29:55,239 INFO ✅ Clicked cookie button using selector: button:has-text('OK')


#
# Fatal process out of memory: Zone
#
----- Native stack trace -----

 1: 00007FF77F33711D
 2: 00007FF77F21181F
 3: 00007FF7804895C6
 4: 00007FF77FE0D6E1
 5: 00007FF77F8DC79B
 6: 00007FF7808C6C87
 7: 00007FF7808C6494
 8: 00007FF7808C6E20
 9: 00007FF7805AC664
10: 00007FF7805A6E6C
11: 00007FF7805A064A
12: 00007FF77FD88314
13: 00007FF77FD41C22
14: 00007FF7800124F5
15: 00007FF77F214540
16: 00007FF77F397463
17: 00007FF780B94C2E
18: 00007FF882D74CB0
19: 00007FF88423E8AB RtlUserThreadStart+43
2025-08-03 08:29:56,910 ERROR Error finding contact links: ElementHandle.text_content: Connection closed while reading from the driver
2025-08-03 08:29:56,911 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contact-us.aspx
2025-08-03 08:29:56,923 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:56,929 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contact-us.html
2025-08-03 08:29:56,932 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:56,935 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contactus
2025-08-03 08:29:56,937 WARNING socket.send() raised exception.
2025-08-03 08:29:56,938 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:56,940 WARNING socket.send() raised exception.
2025-08-03 08:29:56,940 INFO 📝 Attempting contact page: https://www.climatempo.com.br/kontakt
2025-08-03 08:29:56,942 WARNING socket.send() raised exception.
2025-08-03 08:29:56,943 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:56,947 WARNING socket.send() raised exception.
2025-08-03 08:29:56,948 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contact-us
2025-08-03 08:29:56,950 WARNING socket.send() raised exception.
2025-08-03 08:29:56,950 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:56,953 WARNING socket.send() raised exception.
2025-08-03 08:29:56,953 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contact-us-page
2025-08-03 08:29:56,955 WARNING socket.send() raised exception.
2025-08-03 08:29:56,957 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:56,959 WARNING socket.send() raised exception.
2025-08-03 08:29:56,959 INFO 📝 Attempting contact page: https://www.climatempo.com.br/reach-out
2025-08-03 08:29:56,962 WARNING socket.send() raised exception.
2025-08-03 08:29:56,962 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:56,965 WARNING socket.send() raised exception.
2025-08-03 08:29:56,968 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contact.php
2025-08-03 08:29:56,970 WARNING socket.send() raised exception.
2025-08-03 08:29:56,970 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:56,991 WARNING socket.send() raised exception.
2025-08-03 08:29:56,991 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contacto
2025-08-03 08:29:56,994 WARNING socket.send() raised exception.
2025-08-03 08:29:56,995 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:56,997 WARNING socket.send() raised exception.
2025-08-03 08:29:56,998 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contact.aspx
2025-08-03 08:29:57,002 WARNING socket.send() raised exception.
2025-08-03 08:29:57,002 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:57,005 WARNING socket.send() raised exception.
2025-08-03 08:29:57,008 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contact-us.php
2025-08-03 08:29:57,011 WARNING socket.send() raised exception.
2025-08-03 08:29:57,012 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:57,014 WARNING socket.send() raised exception.
2025-08-03 08:29:57,014 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contact
2025-08-03 08:29:57,017 WARNING socket.send() raised exception.
2025-08-03 08:29:57,018 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:57,019 WARNING socket.send() raised exception.
2025-08-03 08:29:57,020 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contact-page
2025-08-03 08:29:57,022 WARNING socket.send() raised exception.
2025-08-03 08:29:57,022 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:57,025 WARNING socket.send() raised exception.
2025-08-03 08:29:57,025 INFO 📝 Attempting contact page: https://www.climatempo.com.br/get-in-touch
2025-08-03 08:29:57,027 WARNING socket.send() raised exception.
2025-08-03 08:29:57,028 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:57,030 WARNING socket.send() raised exception.
2025-08-03 08:29:57,030 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contact-us/
2025-08-03 08:29:57,033 WARNING socket.send() raised exception.
2025-08-03 08:29:57,034 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:57,036 WARNING socket.send() raised exception.
2025-08-03 08:29:57,037 INFO 📝 Attempting contact page: https://www.climatempo.com.br/connect
2025-08-03 08:29:57,041 WARNING socket.send() raised exception.
2025-08-03 08:29:57,041 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:57,044 WARNING socket.send() raised exception.
2025-08-03 08:29:57,044 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contact-form
2025-08-03 08:29:57,047 WARNING socket.send() raised exception.
2025-08-03 08:29:57,049 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:57,051 WARNING socket.send() raised exception.
2025-08-03 08:29:57,052 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contact.html
2025-08-03 08:29:57,054 WARNING socket.send() raised exception.
2025-08-03 08:29:57,054 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:57,057 WARNING socket.send() raised exception.
2025-08-03 08:29:57,057 INFO 📝 Attempting contact page: https://www.climatempo.com.br/en/contact
2025-08-03 08:29:57,060 WARNING socket.send() raised exception.
2025-08-03 08:29:57,060 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:57,063 WARNING socket.send() raised exception.
2025-08-03 08:29:57,065 INFO 📝 Attempting contact page: https://www.climatempo.com.br/contactus/
2025-08-03 08:29:57,067 WARNING socket.send() raised exception.
2025-08-03 08:29:57,068 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:29:57,072 WARNING socket.send() raised exception.
2025-08-03 08:30:05,826 INFO 🌐 Processing domain: www.tempo.com
2025-08-03 08:30:05,831 WARNING socket.send() raised exception.
2025-08-03 08:30:05,831 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:30:05,831 INFO No contact pages found for www.tempo.com
2025-08-03 08:30:05,832 INFO 🔄 Trying fallback contact page: https://www.tempo.com/contact
2025-08-03 08:30:05,833 INFO 📝 Attempting contact page: https://www.tempo.com/contact
2025-08-03 08:30:05,835 WARNING socket.send() raised exception.
2025-08-03 08:30:05,836 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:30:05,839 WARNING socket.send() raised exception.
2025-08-03 08:30:13,818 INFO 🌐 Processing domain: tempo.clicrbs.com.br
2025-08-03 08:30:13,823 WARNING socket.send() raised exception.
2025-08-03 08:30:13,824 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:30:13,824 INFO No contact pages found for tempo.clicrbs.com.br
2025-08-03 08:30:13,825 INFO 🔄 Trying fallback contact page: https://tempo.clicrbs.com.br/contact
2025-08-03 08:30:13,825 INFO 📝 Attempting contact page: https://tempo.clicrbs.com.br/contact
2025-08-03 08:30:13,827 WARNING socket.send() raised exception.
2025-08-03 08:30:13,827 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:30:13,830 WARNING socket.send() raised exception.
2025-08-03 08:30:27,874 INFO 🌐 Processing domain: g1.globo.com
2025-08-03 08:30:27,880 WARNING socket.send() raised exception.
2025-08-03 08:30:27,880 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:30:27,881 INFO No contact pages found for g1.globo.com
2025-08-03 08:30:27,881 INFO 🔄 Trying fallback contact page: https://g1.globo.com/contact
2025-08-03 08:30:27,882 INFO 📝 Attempting contact page: https://g1.globo.com/contact
2025-08-03 08:30:27,884 WARNING socket.send() raised exception.
2025-08-03 08:30:27,884 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:30:27,887 WARNING socket.send() raised exception.
2025-08-03 08:30:35,403 INFO 🌐 Processing domain: www.climaeradar.com.br
2025-08-03 08:30:35,417 WARNING socket.send() raised exception.
2025-08-03 08:30:35,417 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:30:35,418 INFO No contact pages found for www.climaeradar.com.br
2025-08-03 08:30:35,418 INFO 🔄 Trying fallback contact page: https://www.climaeradar.com.br/contact
2025-08-03 08:30:35,419 INFO 📝 Attempting contact page: https://www.climaeradar.com.br/contact
2025-08-03 08:30:35,421 WARNING socket.send() raised exception.
2025-08-03 08:30:35,421 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:30:35,423 WARNING socket.send() raised exception.
2025-08-03 08:30:49,810 INFO 🔍 Searching: luxury lawyers enquiry
2025-08-03 08:30:49,811 INFO Searching DuckDuckGo for: 'luxury lawyers enquiry'
C:\Users\Administrator\Desktop\form filler\f2.py:505: RuntimeWarning: This package (`duckduckgo_search`) has been renamed to `ddgs`! Use `pip install ddgs` instead.
  with DDGS() as ddgs:
2025-08-03 08:30:50,282 INFO response: https://www.bing.com/search?q=luxury+lawyers+enquiry 200
2025-08-03 08:30:50,388 INFO 🌐 Processing domain: belmontenigeria.com
2025-08-03 08:30:50,392 WARNING socket.send() raised exception.
2025-08-03 08:30:50,392 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:30:50,393 INFO No contact pages found for belmontenigeria.com
2025-08-03 08:30:50,393 INFO 🔄 Trying fallback contact page: https://belmontenigeria.com/contact
2025-08-03 08:30:50,394 INFO 📝 Attempting contact page: https://belmontenigeria.com/contact
2025-08-03 08:30:50,395 WARNING socket.send() raised exception.
2025-08-03 08:30:50,396 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:30:50,399 WARNING socket.send() raised exception.
2025-08-03 08:31:02,170 INFO 🌐 Processing domain: landsofnigeria.com
2025-08-03 08:31:02,175 WARNING socket.send() raised exception.
2025-08-03 08:31:02,176 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:31:02,176 INFO No contact pages found for landsofnigeria.com
2025-08-03 08:31:02,177 INFO 🔄 Trying fallback contact page: https://landsofnigeria.com/contact
2025-08-03 08:31:02,177 INFO 📝 Attempting contact page: https://landsofnigeria.com/contact
2025-08-03 08:31:02,179 WARNING socket.send() raised exception.
2025-08-03 08:31:02,180 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:31:02,183 WARNING socket.send() raised exception.
2025-08-03 08:31:17,028 INFO 🌐 Processing domain: www.merriam-webster.com
2025-08-03 08:31:17,034 WARNING socket.send() raised exception.
2025-08-03 08:31:17,036 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:31:17,036 INFO No contact pages found for www.merriam-webster.com
2025-08-03 08:31:17,036 INFO 🔄 Trying fallback contact page: https://www.merriam-webster.com/contact
2025-08-03 08:31:17,037 INFO 📝 Attempting contact page: https://www.merriam-webster.com/contact
2025-08-03 08:31:17,040 WARNING socket.send() raised exception.
2025-08-03 08:31:17,040 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:31:17,043 WARNING socket.send() raised exception.
2025-08-03 08:31:28,595 INFO 🌐 Processing domain: luxuryhotel.guru
2025-08-03 08:31:28,601 WARNING socket.send() raised exception.
2025-08-03 08:31:28,602 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:31:28,602 INFO No contact pages found for luxuryhotel.guru
2025-08-03 08:31:28,603 INFO 🔄 Trying fallback contact page: https://luxuryhotel.guru/contact
2025-08-03 08:31:28,603 INFO 📝 Attempting contact page: https://luxuryhotel.guru/contact
2025-08-03 08:31:28,607 WARNING socket.send() raised exception.
2025-08-03 08:31:28,608 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:31:28,611 WARNING socket.send() raised exception.
2025-08-03 08:31:40,442 INFO 🌐 Processing domain: dictionary.cambridge.org
2025-08-03 08:31:40,484 WARNING socket.send() raised exception.
2025-08-03 08:31:40,485 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:31:40,485 INFO No contact pages found for dictionary.cambridge.org
2025-08-03 08:31:40,486 INFO 🔄 Trying fallback contact page: https://dictionary.cambridge.org/contact
2025-08-03 08:31:40,486 INFO 📝 Attempting contact page: https://dictionary.cambridge.org/contact
2025-08-03 08:31:40,532 WARNING socket.send() raised exception.
2025-08-03 08:31:40,559 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:31:40,566 WARNING socket.send() raised exception.
2025-08-03 08:31:53,082 INFO 🔍 Searching: lawyers Europe contact
2025-08-03 08:31:53,084 INFO Searching DuckDuckGo for: 'lawyers Europe contact'
C:\Users\Administrator\Desktop\form filler\f2.py:505: RuntimeWarning: This package (`duckduckgo_search`) has been renamed to `ddgs`! Use `pip install ddgs` instead.
  with DDGS() as ddgs:
2025-08-03 08:31:53,553 INFO response: https://www.bing.com/search?q=lawyers+Europe+contact 200
2025-08-03 08:31:53,649 INFO 🌐 Processing domain: www.berkeylaw.com
2025-08-03 08:31:53,653 WARNING socket.send() raised exception.
2025-08-03 08:31:53,654 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:31:53,655 INFO No contact pages found for www.berkeylaw.com
2025-08-03 08:31:53,656 INFO 🔄 Trying fallback contact page: https://www.berkeylaw.com/contact
2025-08-03 08:31:53,656 INFO 📝 Attempting contact page: https://www.berkeylaw.com/contact
2025-08-03 08:31:53,659 WARNING socket.send() raised exception.
2025-08-03 08:31:53,659 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:31:53,663 WARNING socket.send() raised exception.
2025-08-03 08:32:05,510 INFO 🌐 Processing domain: www.yelp.com
2025-08-03 08:32:05,514 WARNING socket.send() raised exception.
2025-08-03 08:32:05,515 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:32:05,516 INFO No contact pages found for www.yelp.com
2025-08-03 08:32:05,516 INFO 🔄 Trying fallback contact page: https://www.yelp.com/contact
2025-08-03 08:32:05,517 INFO 📝 Attempting contact page: https://www.yelp.com/contact
2025-08-03 08:32:05,519 WARNING socket.send() raised exception.
2025-08-03 08:32:05,519 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:32:05,521 WARNING socket.send() raised exception.
2025-08-03 08:32:16,053 INFO 🌐 Processing domain: www.justia.com
2025-08-03 08:32:16,057 WARNING socket.send() raised exception.
2025-08-03 08:32:16,057 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:32:16,058 INFO No contact pages found for www.justia.com
2025-08-03 08:32:16,058 INFO 🔄 Trying fallback contact page: https://www.justia.com/contact
2025-08-03 08:32:16,059 INFO 📝 Attempting contact page: https://www.justia.com/contact
2025-08-03 08:32:16,061 WARNING socket.send() raised exception.
2025-08-03 08:32:16,061 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:32:16,063 WARNING socket.send() raised exception.
2025-08-03 08:32:28,185 INFO 🌐 Processing domain: www.lawyers.com
2025-08-03 08:32:28,189 WARNING socket.send() raised exception.
2025-08-03 08:32:28,190 ERROR find_contact error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:32:28,190 INFO No contact pages found for www.lawyers.com
2025-08-03 08:32:28,191 INFO 🔄 Trying fallback contact page: https://www.lawyers.com/contact
2025-08-03 08:32:28,191 INFO 📝 Attempting contact page: https://www.lawyers.com/contact
2025-08-03 08:32:28,193 WARNING socket.send() raised exception.
2025-08-03 08:32:28,193 ERROR form fill error: Page.goto: Connection closed while reading from the driver
2025-08-03 08:32:28,195 WARNING socket.send() raised exception.
2025-08-03 08:32:40,560 INFO 🔄 Completed keyword cycle, restarting in 68 seconds
2025-08-03 08:33:48,570 INFO 🔍 Searching: lawq USA contact
2025-08-03 08:33:48,572 INFO Searching DuckDuckGo for: 'lawq USA contact'
C:\Users\Administrator\Desktop\form filler\f2.py:505: RuntimeWarning: This package (`duckduckgo_search`) has been renamed to `ddgs`! Use `pip install ddgs` instead.
  with DDGS() as ddgs:
2025-08-03 08:33:49,062 INFO response: https://www.bing.com/search?q=lawq+USA+contact 200
2025-08-03 08:33:49,219 WARNING No results found for 'lawq USA contact'
2025-08-03 08:33:49,220 INFO 🔍 Searching: luxury lawyers enquiry
2025-08-03 08:33:49,223 INFO Searching DuckDuckGo for: 'luxury lawyers enquiry'
C:\Users\Administrator\Desktop\form filler\f2.py:505: RuntimeWarning: This package (`duckduckgo_search`) has been renamed to `ddgs`! Use `pip install ddgs` instead.
  with DDGS() as ddgs:
2025-08-03 08:33:49,609 INFO response: https://www.bing.com/search?q=luxury+lawyers+enquiry 200
2025-08-03 08:33:50,074 WARNING No results found for 'luxury lawyers enquiry'
2025-08-03 08:33:50,074 INFO 🔍 Searching: lawyers Europe contact
2025-08-03 08:33:50,076 INFO Searching DuckDuckGo for: 'lawyers Europe contact'
C:\Users\Administrator\Desktop\form filler\f2.py:505: RuntimeWarning: This package (`duckduckgo_search`) has been renamed to `ddgs`! Use `pip install ddgs` instead.
  with DDGS() as ddgs:
2025-08-03 08:33:50,427 INFO response: https://www.bing.com/search?q=lawyers+Europe+contact 200
2025-08-03 08:33:50,511 INFO ⏩ Skipping already processed domain: www.berkeylaw.com
2025-08-03 08:33:50,512 INFO ⏩ Skipping already processed domain: www.yelp.com
2025-08-03 08:33:50,515 INFO ⏩ Skipping already processed domain: www.justia.com
2025-08-03 08:33:50,515 INFO ⏩ Skipping already processed domain: www.lawyers.com
2025-08-03 08:33:50,516 INFO 🔄 Completed keyword cycle, restarting in 59 seconds









































































































